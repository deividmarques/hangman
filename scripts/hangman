#!/bin/bash

# The first arg provided here will be used as command option
COMMAND=$1

function build_containers {
    printf "Creating containers... "
    docker-compose build &> /dev/null
    printf "Created\n"
}

case $COMMAND in
  setup)
    build_containers

    printf "Running mix deps.get to configure project dependencies... "
    docker-compose run api mix deps.get

    printf "Done."
  ;;

  build)
    build_containers
    echo "Done."
  ;;

  db:create)
    echo "Preparing database..."
    docker-compose run api mix ecto.create
    echo "Done"
  ;;

  start)
    echo "Starting all containers..."
    docker-compose up
    echo "Done"
  ;;

  phx:console)
    docker-compose run api iex -S mix phx.server
    echo "Finished"
  ;;

  # Default option, display help information
  *)
    echo "Invalid option. The allowed ones are:"
    echo "setup          - Setup the hangman project"
    echo "run            - Run the hangman server"
    echo "db:create      - Create the hangman database"
    echo "phx:console    - Run the hangman console"
  ;;
esac
